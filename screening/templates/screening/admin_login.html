<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Login - Preeclampsia Prediction System</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'screening/styles.css' %}" />
  </head>
  <body>
    <div class="admin-login-container">
      <div class="admin-form">
        <div class="login-header">
          <div class="logo">
            <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
              <circle
                cx="20"
                cy="20"
                r="18"
                stroke="#FF6B35"
                stroke-width="2"
              />
              <path
                d="M20 10V30M10 20H30"
                stroke="#FF6B35"
                stroke-width="2"
                stroke-linecap="round"
              />
            </svg>
          </div>
          <h1>Admin Login</h1>
          <p>Akses Dashboard Administrator</p>
        </div>

        <form method="POST" action="{% url 'admin_login' %}" class="login-form">
          {% csrf_token %}

          {% if error %}
          <div style="background:#fee2e2;border:1px solid #fca5a5;color:#7f1d1d;padding:10px;border-radius:6px;margin-bottom:12px;">
            {{ error }}
          </div>
          {% endif %}

          {% if messages %}
            {% for message in messages %}
              {% if "success" in message.tags %}
              <div style="background:#ecfdf3;border:1px solid #a7f3d0;color:#065f46;padding:10px;border-radius:6px;margin-bottom:12px;">
                {{ message }}
              </div>
              {% else %}
              <div style="background:#fee2e2;border:1px solid #fca5a5;color:#7f1d1d;padding:10px;border-radius:6px;margin-bottom:12px;">
                {{ message }}
              </div>
              {% endif %}
            {% endfor %}
          {% endif %}

          <div class="form-group">
            <label for="admin_email">Email Admin</label>
            <input
              type="email"
              id="admin_email"
              name="email"
              placeholder="Masukkan email admin"
              required
            />
          </div>

          <div class="form-group">
            <label for="admin_password">Password</label>
            <div class="password-input-wrapper">
              <input
                type="password"
                id="admin_password"
                name="password"
                placeholder="Masukkan password"
                required
              />
              <button
                type="button"
                class="password-toggle"
                onclick="togglePassword('admin_password')"
              >
                <svg
                  id="admin_password-icon"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
                  <circle cx="12" cy="12" r="3" />
                </svg>
              </button>
            </div>
          </div>

          <button type="submit" class="btn btn-primary btn-full">
            Login Admin
          </button>
        </form>

        <p class="login-footer">
          Kembali ke
          <a href="{% url 'login' %}" class="link-button"> User Login </a>
        </p>

        {% if messages %}
        <div id="django-messages" style="display:none;">
          {% for message in messages %}
          <div data-message="{{ message|escapejs }}"></div>
          {% endfor %}
        </div>
        <script>
          document.addEventListener("DOMContentLoaded", function () {
            document
              .querySelectorAll('#django-messages [data-message]')
              .forEach(function (el) {
                alert(el.getAttribute("data-message"));
              });
          });
        </script>
        {% endif %}
      </div>
    </div>

    <!-- =================== PASSWORD TOGGLE SCRIPT =================== -->
    <script>
      function togglePassword(inputId) {
        const input = document.getElementById(inputId);
        const icon = document.getElementById(inputId + "-icon");

        if (!input || !icon) return;

        if (input.type === "password") {
          input.type = "text";

          // icon eye-off
          icon.innerHTML = `
            <path d="M17.94 17.94A10.94 10.94 0 0 1 12 20c-7 0-11-8-11-8a20.3 20.3 0 0 1 4.21-5.39"/>
            <path d="M9.9 4.24A10.94 10.94 0 0 1 12 4c7 0 11 8 11 8a20.38 20.38 0 0 1-2.25 3.25"/>
            <path d="M1 1l22 22"/>
          `;
        } else {
          input.type = "password";

          // icon eye default
          icon.innerHTML = `
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
            <circle cx="12" cy="12" r="3" />
          `;
        }
      }
    </script>
  </body>
</html>
